Ｍａｃ　ｉｎ　Ｘ６８Ｋ　（５インチ対応暫定バージョン）

　みなさんどうもこんにちは．Mac in X68K をお使いの方にはいつもご迷惑を

おかけしてどうもすみません．さて今回のバージョンアップでは、

なんとか５インチディスクが使えるようにしたものです。

デバッグが十分でないので、ハングすることがありますので十分注意してください。

操作環境は、本物とほとんど一緒にしたつもりです。以下簡単な説明をします。

-------------------------------------------------------------------------------
＊動作させるに必要なもの

	メインメモリ２Ｍバイト以上のＸ６８０００
	マックプラスのＲＯＭイメージ
	マックのディスクのイメージを５インチにコンバートしたもの

	注）演算プロセッサボードをつけているとなぜか動かないみたいですので、
	　　もし動かなかったときは外しておいてください。

	　　プログラム実行中は、デバッグをしない限り「ＨＥＬＰ」キーを
	　　押さないでください！！

-------------------------------------------------------------------------------
＊付属ファイル

	mac.z		プログラム本体
	patch.sys	ＲＯＭパッチリダイレクトファイル
	f512.c		512 bytes / sector フォーマットプログラムソース
	f512.x		上　実行ファイル
	conv.c		human file　をコンバートするプログラムソース
	conv.x		上　実行ファイル
	m.x		プログラムカスタマイズ用（実行しないでね）

-------------------------------------------------------------------------------
＊ディスクのコンバート

	前回までのバージョンは、メモリにディスクイメージをもたせて動かして

	きましたが、今回から、マックの３．５インチディスクを５インチディスクに

	置き換えることにしました。さてマックのディスクは 512 bytes / sector

	になっていますので、いままで転送したディスクイメージファイルを

	512 bytes / sector のディスクにコンバートする必要があります。

	この作業を行うためのプログラムが、f512.x と conv.x です。

	f512.x は、

		f512

	でドライブ１にあるディスクをフォーマットします。

	conv.x は、

		conv filename

	で filename というディスクイメージファイルをドライブ１にある

	512 bytes / sector でフォーマット済みのディスクにコンバートします。

-------------------------------------------------------------------------------
＊ＭＡＣ．Ｚを実行するための準備

	まず、メモリの＄１ｅ００００からＲＯＭのイメージをロードし、
	パッチをあてます。操作としてはデバッガを使って

		db ROM,1e0000		ＲＯＭイメージのロード

		db <patch.sys		パッチをあてる

	というようにします。以上準備ができたならコンバートしたディスクを
	ドライブにいれて　ｍａｃ．ｚ　を実行します。
	以後マックの操作環境になります。

-------------------------------------------------------------------------------
＊システムのバージョンについて

	いまのところ、動くようにしているシステムは、英語版の
		system 3.00
		system 6.02
		system 6.03
	になっています。かならずしも完動とはいいがたいのですが、
	ただ上記のシステムの PTCH リソースをサポートしているだけです。
	他のバージョンの PTCH リソースがわかれば対応可能となっています。

-------------------------------------------------------------------------------
＊ディスクの操作

	システム起動時は、ドライブ１のディスクの挿入のイベントがはいりません
	ので　「登録」キーをおしてディスクをマウントしてください、以後
	アプリケーションを動作させない限り、ディスク挿入で自動マウントします。

-------------------------------------------------------------------------------
＊デバッガについて

	システムデバッグのために、ＲＯＭデバッガと同じものが動作しています
	「ＨＥＬＰ」キーを押すと、現在実行中のＡライントラップをターミナルに
	送ります、それゆえ、ターミナルをつないでないかたは、・絶・対・に・
	ヘルプキーをおさないでください。

-------------------------------------------------------------------------------
＊プログラムのカスタマイズ

	メモリが余裕のある方はメモリサイズを大きくできます。そのためには
	メモリサイズと、ＲＯＭイメージのロード位置をかえる必要があります。
	各自以下の資料を参考に、m.x を変更し .z 形式にコンバートしてください。

	m.x	の構成
	+$00
		$40 バイトは　．ｘファイルのヘッダ

	+$40	start		bra.s	start0
		****************
	+$42	MemSize		dc.l	$100000		メモリサイズは１Ｍ
	+$46	rom_base	dc.l	ROM_ADDRESS	ROM image address
	+$4a	screen		dc.l	TEXT		screen base
	+$4e	v_res		dc.w	$200		V 画面縦サイズ
	+$50	h_res		dc.w	$300		H 画面横サイズ

	あと、ＲＯＭパッチのためのリダイレクトファイル patch.sys を書換え
	なくてはなりません
		Z0=1E0000
	となっているところを、各自のＲＯＭイメージロード位置の
	アドレスに変更してください。

-------------------------------------------------------------------------------
＊終わりに

	一応なんとかディスクを動かすことができました、いろいろＦＤＣに

	悩まされましたが、ＸでＤＭＡを使わないでＦＤＣを動かすのは

	難しいと痛感させられました。でも、ディスクアクセス中のマウスの動きは

	本物みたいでしょ・・・・

	さて、今度は何をやろうかなと、いろいろと思案中です。今度の

	バージョンアップを期待してください。

	なお、暴走などのリポートを報告いただければ、今度のバージョンアップに

	盛り込めるかもしれませんので、どしどしご意見ご希望をください。

	０８−０９−’８９		ＭａｃＸ

-------------------------------------------------------------------------------
追伸

	来週は、いなかに帰っているのでアクセスはしばらっくストップします。
	では　では
